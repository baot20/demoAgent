# Supervisor Agent é›†æˆæŒ‡å—

æœ¬æ–‡æ¡£è¯´æ˜å¦‚ä½•è®© Supervisor Agent æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨ S3 é¢„å®¡ Agentã€‚

## ğŸ¤– Agent åŸºæœ¬ä¿¡æ¯

### Agent æ ‡è¯†
- **åç§°**: S3PreauditAgent
- **ç‰ˆæœ¬**: 1.0.0
- **ç±»å‹**: preaudit_system
- **åˆ†ç±»**: content_validation

### æ ¸å¿ƒåŠŸèƒ½æè¿°
```
S3æ–‡ä»¶é¢„å®¡ç³»ç»ŸAgent - ä¸“é—¨ç”¨äºæ£€æŸ¥ç”¨æˆ·è¾“å…¥å†…å®¹å’ŒS3å­˜å‚¨æ¡¶æ–‡ä»¶æ•°é‡çš„é¢„å®¡åˆ¤æ–­ç³»ç»Ÿã€‚

ä¸»è¦åŠŸèƒ½ï¼š
1. æ£€æŸ¥ç”¨æˆ·è¾“å…¥å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«æŒ‡å®šå…³é”®è¯ï¼ˆé»˜è®¤ï¼šé²å¨œï¼‰
2. æ£€æŸ¥æŒ‡å®šS3å­˜å‚¨æ¡¶ä¸­çš„æ–‡ä»¶æ•°é‡æ˜¯å¦æ»¡è¶³æœ€å°è¦æ±‚ï¼ˆé»˜è®¤ï¼š>3ä¸ªï¼‰
3. ç»¼åˆåˆ¤æ–­é¢„å®¡ç»“æœï¼šåªæœ‰å½“ç”¨æˆ·è¾“å…¥åŒ…å«å…³é”®è¯ä¸”æ–‡ä»¶æ•°é‡æ»¡è¶³è¦æ±‚æ—¶æ‰é€šè¿‡é¢„å®¡

é€‚ç”¨åœºæ™¯ï¼š
- å†…å®¹åˆè§„æ€§æ£€æŸ¥
- æ–‡ä»¶æ•°é‡éªŒè¯
- è‡ªåŠ¨åŒ–é¢„å®¡æµç¨‹
- æ¡ä»¶æ€§å®¡æ‰¹ç³»ç»Ÿ
```

## ğŸ› ï¸ å¯ç”¨å·¥å…·è¯¦è§£

### 1. list_s3_files
**ç”¨é€”**: è·å–S3å­˜å‚¨æ¡¶æ–‡ä»¶åˆ—è¡¨å’Œæ•°é‡ç»Ÿè®¡
```python
# è°ƒç”¨æ–¹å¼
list_s3_files(bucket_name="my-bucket")  # æŒ‡å®šå­˜å‚¨æ¡¶
list_s3_files()  # ä½¿ç”¨é»˜è®¤é…ç½®çš„å­˜å‚¨æ¡¶

# è¿”å›æ ¼å¼
{
    "success": True,
    "file_count": 5,
    "files": ["file1.txt", "file2.txt", ...],
    "bucket_name": "my-bucket"
}
```

### 2. check_string_content
**ç”¨é€”**: æ£€æŸ¥æ–‡æœ¬å†…å®¹æ˜¯å¦åŒ…å«ç›®æ ‡å…³é”®è¯
```python
# è°ƒç”¨æ–¹å¼
check_string_content("ä½ å¥½é²å¨œï¼Œä»Šå¤©å¤©æ°”ä¸é”™")  # ä½¿ç”¨é»˜è®¤å…³é”®è¯
check_string_content("æµ‹è¯•å†…å®¹", "è‡ªå®šä¹‰å…³é”®è¯")  # è‡ªå®šä¹‰å…³é”®è¯

# è¿”å›æ ¼å¼
{
    "input_string": "ä½ å¥½é²å¨œï¼Œä»Šå¤©å¤©æ°”ä¸é”™",
    "target_word": "é²å¨œ",
    "contains_target": True,
    "string_length": 12
}
```

### 3. perform_preaudit
**ç”¨é€”**: æ‰§è¡Œå®Œæ•´çš„é¢„å®¡æµç¨‹å’Œåˆ¤æ–­
```python
# è°ƒç”¨æ–¹å¼
perform_preaudit("ä½ å¥½é²å¨œï¼Œä»Šå¤©å¤©æ°”ä¸é”™")  # ä½¿ç”¨é»˜è®¤é…ç½®
perform_preaudit("æµ‹è¯•å†…å®¹", "custom-bucket")  # æŒ‡å®šå­˜å‚¨æ¡¶

# è¿”å›æ ¼å¼
"é¢„å®¡é€šè¿‡ - ç”¨æˆ·è¾“å…¥åŒ…å«'é²å¨œ'ä¸” S3 å­˜å‚¨æ¡¶ 'my-bucket' ä¸­æœ‰ 5 ä¸ªæ–‡ä»¶ï¼ˆè¶…è¿‡3ä¸ªï¼‰"
# æˆ–
"é¢„å®¡ä¸é€šè¿‡ - ç”¨æˆ·è¾“å…¥ä¸åŒ…å«'é²å¨œ'"
```

### 4. get_current_config
**ç”¨é€”**: è·å–å½“å‰ç³»ç»Ÿé…ç½®ä¿¡æ¯
```python
# è°ƒç”¨æ–¹å¼
get_current_config()

# è¿”å›æ ¼å¼
{
    "aws_region": "us-east-1",
    "s3_bucket": "my-bucket",
    "target_word": "é²å¨œ",
    "min_file_count": 3
}
```

## ğŸ“‹ Supervisor Agent è°ƒç”¨æŒ‡å—

### åŸºæœ¬è°ƒç”¨æ¨¡å¼

#### 1. ç®€å•é¢„å®¡æ£€æŸ¥
```python
message = 'è¯·å¯¹ç”¨æˆ·è¾“å…¥"ä½ å¥½é²å¨œï¼Œä»Šå¤©å¤©æ°”ä¸é”™"è¿›è¡Œé¢„å®¡æ£€æŸ¥'
response = preaudit_agent(message)
```

#### 2. è¯¦ç»†é¢„å®¡æ£€æŸ¥
```python
message = """
è¯·å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œè¯¦ç»†çš„é¢„å®¡æ£€æŸ¥ï¼š"ä½ å¥½é²å¨œï¼Œä»Šå¤©å¤©æ°”ä¸é”™"

è¯·æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š
1. ä½¿ç”¨ get_current_config å·¥å…·è·å–å½“å‰é…ç½®ä¿¡æ¯
2. ä½¿ç”¨ check_string_content å·¥å…·æ£€æŸ¥ç”¨æˆ·è¾“å…¥æ˜¯å¦åŒ…å«ç›®æ ‡è¯æ±‡
3. ä½¿ç”¨ list_s3_files å·¥å…·æ£€æŸ¥ S3 å­˜å‚¨æ¡¶ä¸­çš„æ–‡ä»¶æ•°é‡
4. ä½¿ç”¨ perform_preaudit å·¥å…·æ‰§è¡Œå®Œæ•´çš„é¢„å®¡æµç¨‹
5. æ ¹æ®é¢„å®¡ç»“æœç»™å‡ºæ˜ç¡®çš„"é¢„å®¡é€šè¿‡"æˆ–"é¢„å®¡ä¸é€šè¿‡"çš„ç»“è®º

è¯·è¯¦ç»†è¯´æ˜æ£€æŸ¥è¿‡ç¨‹å’Œç»“æœã€‚
"""
response = preaudit_agent(message)
```

#### 3. è‡ªå®šä¹‰å‚æ•°æ£€æŸ¥
```python
message = """
è¯·ä½¿ç”¨å­˜å‚¨æ¡¶"custom-bucket"å¯¹ç”¨æˆ·è¾“å…¥"æµ‹è¯•å†…å®¹"è¿›è¡Œé¢„å®¡æ£€æŸ¥ï¼Œ
å¹¶æ£€æŸ¥æ˜¯å¦åŒ…å«å…³é”®è¯"è‡ªå®šä¹‰è¯æ±‡"ã€‚
"""
response = preaudit_agent(message)
```

### ç»“æœè§£é‡ŠæŒ‡å—

#### æˆåŠŸå“åº”æ¨¡å¼
- åŒ…å« "é¢„å®¡é€šè¿‡" å…³é”®è¯
- è¯¦ç»†è¯´æ˜é€šè¿‡çš„åŸå› 
- åŒ…å«å…·ä½“çš„æ£€æŸ¥æ•°æ®ï¼ˆæ–‡ä»¶æ•°é‡ã€å…³é”®è¯ç­‰ï¼‰

#### å¤±è´¥å“åº”æ¨¡å¼
- åŒ…å« "é¢„å®¡ä¸é€šè¿‡" å…³é”®è¯
- æ˜ç¡®è¯´æ˜ä¸é€šè¿‡çš„å…·ä½“åŸå› 
- å¯èƒ½çš„åŸå› ï¼š
  - "ç”¨æˆ·è¾“å…¥ä¸åŒ…å«'å…³é”®è¯'"
  - "S3å­˜å‚¨æ¡¶ä¸­åªæœ‰Xä¸ªæ–‡ä»¶ï¼ˆéœ€è¦è¶…è¿‡Yä¸ªï¼‰"
  - "S3å­˜å‚¨æ¡¶è®¿é—®å¤±è´¥"

#### é”™è¯¯å“åº”æ¨¡å¼
- åŒ…å«é”™è¯¯ä¿¡æ¯å’Œå»ºè®®
- å¸¸è§é”™è¯¯ï¼š
  - AWSå‡­è¯é—®é¢˜
  - ç½‘ç»œè¿æ¥é—®é¢˜
  - é…ç½®æ–‡ä»¶é—®é¢˜

## ğŸ¯ ä½¿ç”¨åœºæ™¯ç¤ºä¾‹

### åœºæ™¯1: å†…å®¹å‘å¸ƒé¢„å®¡
```python
# Supervisor Agent å¯ä»¥è¿™æ ·è°ƒç”¨
def content_publish_preaudit(content):
    message = f"""
    è¿™æ˜¯ä¸€ä¸ªå†…å®¹å‘å¸ƒé¢„å®¡è¯·æ±‚ã€‚
    è¯·æ£€æŸ¥ä»¥ä¸‹å†…å®¹æ˜¯å¦ç¬¦åˆå‘å¸ƒè¦æ±‚ï¼š"{content}"
    
    éœ€è¦éªŒè¯ï¼š
    1. å†…å®¹æ˜¯å¦åŒ…å«å¿…è¦çš„å®¡æ ¸æ ‡è¯†
    2. æ”¯æ’‘æ–‡ä»¶æ•°é‡æ˜¯å¦è¶³å¤Ÿ
    
    è¯·ç»™å‡ºè¯¦ç»†çš„é¢„å®¡ç»“æœå’Œå»ºè®®ã€‚
    """
    return preaudit_agent(message)
```

### åœºæ™¯2: æ‰¹é‡é¢„å®¡æ£€æŸ¥
```python
def batch_preaudit(content_list):
    results = []
    for content in content_list:
        message = f'è¯·å¯¹å†…å®¹"{content}"è¿›è¡Œå¿«é€Ÿé¢„å®¡æ£€æŸ¥'
        result = preaudit_agent(message)
        results.append({
            'content': content,
            'result': result,
            'passed': 'é¢„å®¡é€šè¿‡' in result
        })
    return results
```

### åœºæ™¯3: æ¡ä»¶æ€§å®¡æ‰¹
```python
def conditional_approval(user_request):
    message = f"""
    è¿™æ˜¯ä¸€ä¸ªå®¡æ‰¹è¯·æ±‚çš„é¢„å®¡æ£€æŸ¥ã€‚
    ç”¨æˆ·è¯·æ±‚ï¼š"{user_request}"
    
    è¯·æ£€æŸ¥æ˜¯å¦æ»¡è¶³è‡ªåŠ¨å®¡æ‰¹çš„æ¡ä»¶ï¼š
    1. è¯·æ±‚å†…å®¹åŒ…å«å¿…è¦çš„æ ‡è¯†
    2. ç›¸å…³æ–‡ä»¶æ•°é‡æ»¡è¶³è¦æ±‚
    
    å¦‚æœæ»¡è¶³æ¡ä»¶ï¼Œå¯ä»¥è¿›å…¥è‡ªåŠ¨å®¡æ‰¹æµç¨‹ã€‚
    å¦‚æœä¸æ»¡è¶³ï¼Œéœ€è¦äººå·¥å®¡æ ¸ã€‚
    """
    return preaudit_agent(message)
```

## âš™ï¸ é…ç½®å’Œå®šåˆ¶

### å¯é…ç½®å‚æ•°
- `TARGET_WORD`: é¢„å®¡æ£€æŸ¥çš„ç›®æ ‡å…³é”®è¯ï¼ˆé»˜è®¤ï¼š"é²å¨œ"ï¼‰
- `MIN_FILE_COUNT`: S3æ–‡ä»¶æ•°é‡æœ€å°è¦æ±‚ï¼ˆé»˜è®¤ï¼š3ï¼‰
- `AWS_REGION`: AWSæœåŠ¡åŒºåŸŸï¼ˆé»˜è®¤ï¼š"us-east-1"ï¼‰
- `S3_BUCKET_NAME`: é»˜è®¤S3å­˜å‚¨æ¡¶åç§°

### è¿è¡Œæ—¶é…ç½®æŸ¥è¯¢
```python
# Supervisor Agent å¯ä»¥æŸ¥è¯¢å½“å‰é…ç½®
message = "è¯·å‘Šè¯‰æˆ‘å½“å‰çš„é¢„å®¡é…ç½®å‚æ•°"
config_info = preaudit_agent(message)
```

## ğŸ” ç›‘æ§å’Œè°ƒè¯•

### æ€§èƒ½æŒ‡æ ‡
- **å…¸å‹å“åº”æ—¶é—´**: 2-5ç§’
- **å½±å“å› ç´ **: S3å­˜å‚¨æ¡¶å¤§å°ã€ç½‘ç»œå»¶è¿Ÿã€AWS APIå“åº”æ—¶é—´

### æ—¥å¿—çº§åˆ«
- **INFO**: æ­£å¸¸æ“ä½œå’Œç»“æœ
- **WARNING**: é…ç½®é—®é¢˜å’Œæ€§èƒ½è­¦å‘Š  
- **ERROR**: AWSè¿æ¥é”™è¯¯å’Œç³»ç»Ÿæ•…éšœ

### å¥åº·æ£€æŸ¥
```python
# Supervisor Agent å¯ä»¥æ‰§è¡Œå¥åº·æ£€æŸ¥
health_check_message = """
è¯·æ‰§è¡Œç³»ç»Ÿå¥åº·æ£€æŸ¥ï¼š
1. æ£€æŸ¥å½“å‰é…ç½®æ˜¯å¦æ­£å¸¸
2. æµ‹è¯•S3è¿æ¥æ˜¯å¦æ­£å¸¸
3. éªŒè¯é¢„å®¡åŠŸèƒ½æ˜¯å¦å·¥ä½œæ­£å¸¸
"""
health_status = preaudit_agent(health_check_message)
```

## ğŸš¨ é”™è¯¯å¤„ç†

### å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ

1. **AWSå‡­è¯æ— æ•ˆ**
   - é”™è¯¯ä¿¡æ¯: "AWSå‡­è¯æ— æ•ˆ" æˆ– "è®¿é—®è¢«æ‹’ç»"
   - è§£å†³æ–¹æ¡ˆ: æ£€æŸ¥.configæ–‡ä»¶ä¸­çš„AWSå‡­è¯é…ç½®

2. **S3å­˜å‚¨æ¡¶ä¸å­˜åœ¨**
   - é”™è¯¯ä¿¡æ¯: "å­˜å‚¨æ¡¶ä¸å­˜åœ¨" æˆ– "NoSuchBucket"
   - è§£å†³æ–¹æ¡ˆ: éªŒè¯å­˜å‚¨æ¡¶åç§°å’Œè®¿é—®æƒé™

3. **ç½‘ç»œè¿æ¥é—®é¢˜**
   - é”™è¯¯ä¿¡æ¯: "è¿æ¥è¶…æ—¶" æˆ– "ç½‘ç»œé”™è¯¯"
   - è§£å†³æ–¹æ¡ˆ: æ£€æŸ¥ç½‘ç»œè¿æ¥å’ŒAWSæœåŠ¡çŠ¶æ€

### Supervisor Agent é”™è¯¯å¤„ç†ç¤ºä¾‹
```python
def safe_preaudit_call(content):
    try:
        message = f'è¯·å¯¹å†…å®¹"{content}"è¿›è¡Œé¢„å®¡æ£€æŸ¥'
        result = preaudit_agent(message)
        
        if "é¢„å®¡é€šè¿‡" in result:
            return {"status": "passed", "message": result}
        elif "é¢„å®¡ä¸é€šè¿‡" in result:
            return {"status": "failed", "message": result}
        else:
            return {"status": "error", "message": result}
            
    except Exception as e:
        return {"status": "error", "message": f"é¢„å®¡ç³»ç»Ÿè°ƒç”¨å¤±è´¥: {str(e)}"}
```

## ğŸ“š å®Œæ•´é›†æˆç¤ºä¾‹

å‚è€ƒ `supervisor_example.py` æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«äº†å®Œæ•´çš„ Supervisor Agent é›†æˆç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•ï¼š

1. åˆ›å»º Supervisor Agent
2. å®šä¹‰è°ƒç”¨é¢„å®¡ Agent çš„å·¥å…·
3. å¤„ç†å„ç§é¢„å®¡åœºæ™¯
4. è§£é‡Šå’Œè½¬æ¢é¢„å®¡ç»“æœ
5. æä¾›ç”¨æˆ·å‹å¥½çš„äº¤äº’ç•Œé¢

é€šè¿‡è¿™äº›ä¿¡æ¯ï¼ŒSupervisor Agent å¯ä»¥æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨ S3 é¢„å®¡ Agentï¼Œæä¾›æ›´æ™ºèƒ½çš„é¢„å®¡æœåŠ¡ï¼
